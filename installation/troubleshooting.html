

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Troubleshooting &mdash; cpymad 1.6.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Getting Started" href="../getting-started.html" />
    <link rel="prev" title="MacOS (experimental)" href="macos.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> cpymad
          

          
          </a>

          
            
            
              <div class="version">
                1.6.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../building.html">Building from source</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="unix.html">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows.html">Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="macos.html">MacOS (experimental)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup-or-compile-time-errors">Setup or compile time errors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#error-no-matching-distribution-found">ERROR: No matching distribution found</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fatal-error-madx-mad-types-f-h-no-such-file-or-directory">fatal error: <code class="docutils literal notranslate"><span class="pre">madX/mad_types_f.h</span></code>: No such file or directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#oserror-missing-source-file">OSError: Missing source file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#runtime-errors">Runtime errors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#importerror-undefined-symbol-dgelsd">ImportError: undefined symbol: dgelsd_</a></li>
<li class="toctree-l4"><a class="reference internal" href="#importerror-libmadx-so">ImportError: libmadx.so</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpymad/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../known-issues.html">Known issues</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cpymad</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../building.html">Building from source</a> &raquo;</li>
        
      <li>Troubleshooting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/installation/troubleshooting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="troubleshooting">
<span id="id1"></span><h1>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h1>
<p>In the following we will try to keep a list of the various issues and fixes
that might occur during or after installation.</p>
<p>After a successful installation, please use the following command to verify
that the extension can be loaded:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -c <span class="s2">&quot;import cpymad.libmadx as l; l.start()&quot;</span>
</pre></div>
</div>
<p>The MAD-X banner should appear.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#setup-or-compile-time-errors" id="id2">Setup or compile time errors</a></p>
<ul>
<li><p><a class="reference internal" href="#error-no-matching-distribution-found" id="id3">ERROR: No matching distribution found</a></p></li>
<li><p><a class="reference internal" href="#fatal-error-madx-mad-types-f-h-no-such-file-or-directory" id="id4">fatal error: <code class="docutils literal notranslate"><span class="pre">madX/mad_types_f.h</span></code>: No such file or directory</a></p></li>
<li><p><a class="reference internal" href="#oserror-missing-source-file" id="id5">OSError: Missing source file</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#runtime-errors" id="id6">Runtime errors</a></p>
<ul>
<li><p><a class="reference internal" href="#importerror-undefined-symbol-dgelsd" id="id7">ImportError: undefined symbol: dgelsd_</a></p></li>
<li><p><a class="reference internal" href="#importerror-libmadx-so" id="id8">ImportError: libmadx.so</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="setup-or-compile-time-errors">
<h2><a class="toc-backref" href="#id2">Setup or compile time errors</a><a class="headerlink" href="#setup-or-compile-time-errors" title="Permalink to this headline">¶</a></h2>
<p>Errors that occur during the execution of <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">cpymad</span></code> or <code class="docutils literal notranslate"><span class="pre">python</span>
<span class="pre">setup.py</span> <span class="pre">build</span></code>.</p>
<div class="section" id="error-no-matching-distribution-found">
<h3><a class="toc-backref" href="#id3">ERROR: No matching distribution found</a><a class="headerlink" href="#error-no-matching-distribution-found" title="Permalink to this headline">¶</a></h3>
<p>Problem: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">cpymad</span></code> fails with either or both of these messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ERROR</span><span class="p">:</span> <span class="n">Could</span> <span class="ow">not</span> <span class="n">find</span> <span class="n">a</span> <span class="n">version</span> <span class="n">that</span> <span class="n">satisfies</span> <span class="n">the</span> <span class="n">requirement</span> <span class="n">cpymad</span>
<span class="n">ERROR</span><span class="p">:</span> <span class="n">No</span> <span class="n">matching</span> <span class="n">distribution</span> <span class="n">found</span> <span class="k">for</span> <span class="n">cpymad</span>
</pre></div>
</div>
<p>This usually means that we haven’t uploaded wheels for your platform or python
version. In this case, either ping us about adding a corresponding wheel, or
refer to the platform specific <a class="reference external" href="./installation">Installation Instructions</a>.</p>
</div>
<div class="section" id="fatal-error-madx-mad-types-f-h-no-such-file-or-directory">
<h3><a class="toc-backref" href="#id4">fatal error: <code class="docutils literal notranslate"><span class="pre">madX/mad_types_f.h</span></code>: No such file or directory</a><a class="headerlink" href="#fatal-error-madx-mad-types-f-h-no-such-file-or-directory" title="Permalink to this headline">¶</a></h3>
<p>Problem: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">cpymad</span></code> fails and shows an error similar to the
following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gcc</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">-</span><span class="n">c</span> <span class="n">src</span><span class="o">/</span><span class="n">cpymad</span><span class="o">/</span><span class="n">libmadx</span><span class="o">.</span><span class="n">c</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="n">src</span><span class="o">/</span><span class="n">cpymad</span><span class="o">/</span><span class="n">libmadx</span><span class="o">.</span><span class="n">c</span><span class="p">:</span><span class="mi">642</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span><span class="p">:</span> <span class="n">madX</span><span class="o">/</span><span class="n">mad_types_f</span><span class="o">.</span><span class="n">h</span><span class="p">:</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span>
  <span class="mi">642</span> <span class="o">|</span> <span class="c1">#include &quot;madX/mad_types_f.h&quot;</span>
      <span class="o">|</span>          <span class="o">^~~~~~~~~~~~~~~~~~~~</span>
<span class="n">compilation</span> <span class="n">terminated</span><span class="o">.</span>
<span class="n">error</span><span class="p">:</span> <span class="n">command</span> <span class="s1">&#39;gcc&#39;</span> <span class="n">failed</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">status</span> <span class="mi">1</span>
<span class="o">----------------------------------------</span>
<span class="n">ERROR</span><span class="p">:</span> <span class="n">Command</span> <span class="n">errored</span> <span class="n">out</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">status</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>This occurs because pip couldn’t find a prebuilt binary wheel that is
compatible with your platform, and tried to build the source distribution
instead. Please ping us about adding a wheel for your platform or refer to the
<a class="reference internal" href="../building.html#building-from-source"><span class="std std-ref">Building from source</span></a> guide.</p>
</div>
<div class="section" id="oserror-missing-source-file">
<h3><a class="toc-backref" href="#id5">OSError: Missing source file</a><a class="headerlink" href="#oserror-missing-source-file" title="Permalink to this headline">¶</a></h3>
<p>Message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">OSError</span><span class="p">:</span> <span class="n">Missing</span> <span class="n">source</span> <span class="n">file</span><span class="p">:</span> <span class="s1">&#39;cpymad/libmadx.c&#39;</span><span class="o">.</span> <span class="n">Install</span> <span class="n">Cython</span> <span class="n">to</span> <span class="n">resolve</span> <span class="n">this</span> <span class="n">problem</span><span class="o">.</span>
</pre></div>
</div>
<p>This can occur if building cpymad from a local checkout without having Cython
installed. The solution is to install cython and try again:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install cython
</pre></div>
</div>
</div>
</div>
<div class="section" id="runtime-errors">
<h2><a class="toc-backref" href="#id6">Runtime errors</a><a class="headerlink" href="#runtime-errors" title="Permalink to this headline">¶</a></h2>
<p>Errors that occur after a successful installation when trying to use cpymad.</p>
<div class="section" id="importerror-undefined-symbol-dgelsd">
<h3><a class="toc-backref" href="#id7">ImportError: undefined symbol: dgelsd_</a><a class="headerlink" href="#importerror-undefined-symbol-dgelsd" title="Permalink to this headline">¶</a></h3>
<p>Message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">]</span><span class="o">/</span><span class="n">cpymad</span><span class="o">/</span><span class="n">libmadx</span><span class="o">.</span><span class="n">so</span><span class="p">:</span> <span class="n">undefined</span> <span class="n">symbol</span><span class="p">:</span> <span class="n">dgelsd_</span>
</pre></div>
</div>
<p>This message is the result of linking cpymad’s libmadx extension module
without a required dependency. In the specific case above, it means that MAD-X
was built with BLAS/LAPACK, but cpymad was not linked against these libraries.
The cpymad setup currently has no mechanism to detect with which libraries
MAD-X was built and assumes by default only some standard libraries.</p>
<p>Possible solutions are either rebuilding MAD-X without BLAS/LAPACK, or passing
appropriate libraries during the cpymad build step. The latter can be done by
through environment variables:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">BLAS</span><span class="o">=</span><span class="m">1</span>
<span class="nb">export</span> <span class="nv">LAPACK</span><span class="o">=</span><span class="m">1</span>
pip install .
</pre></div>
</div>
<p>Or by passing linker flags to the <code class="docutils literal notranslate"><span class="pre">setup.py</span> <span class="pre">build_ext</span></code> command manually:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python setup.py build_ext -lblas -llapack
</pre></div>
</div>
</div>
<div class="section" id="importerror-libmadx-so">
<h3><a class="toc-backref" href="#id8">ImportError: libmadx.so</a><a class="headerlink" href="#importerror-libmadx-so" title="Permalink to this headline">¶</a></h3>
<p>Message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="n">libmadx</span><span class="o">.</span><span class="n">so</span><span class="p">:</span> <span class="n">cannot</span> <span class="nb">open</span> <span class="n">shared</span> <span class="nb">object</span> <span class="n">file</span><span class="p">:</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span>
</pre></div>
</div>
<p>This error can have multiple causes. It often means that cpymad is linked
against one or more dynamic libraries that could not be found at runtime.
Reasons may be that the MAD-X installation was moved or removed after building
cpymad.</p>
<p>A possible solution is to use a permanent installation directory for MAD-X and
specify this during the build:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">MADXDIR</span><span class="o">=</span>&lt;madx-install-prefix&gt;
pip install .
</pre></div>
</div>
<p>Another possible solution is to specify the appropriate <code class="docutils literal notranslate"><span class="pre">RPATH</span></code> to the setup
script when building:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python setup.py build_ext --rpath<span class="o">=</span>&lt;rpath&gt;
python setup.py install
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">&lt;madx-install-prefix&gt;</span></code> is the base folder containing the subfolders
<code class="docutils literal notranslate"><span class="pre">bin</span></code>, <code class="docutils literal notranslate"><span class="pre">include</span></code>, <code class="docutils literal notranslate"><span class="pre">lib</span></code> of the MAD-X build and <code class="docutils literal notranslate"><span class="pre">&lt;rpath&gt;</span></code> contains the
dynamic library files.</p>
<p>If this does not work, you can set the <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> (or
<code class="docutils literal notranslate"><span class="pre">DYLD_LIBRARY_PATH</span></code> on OSX) environment variable before running pymad, for
example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:<span class="nv">$HOME</span>/.local/lib/
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../getting-started.html" class="btn btn-neutral float-right" title="Getting Started" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="macos.html" class="btn btn-neutral float-left" title="MacOS (experimental)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2014-2020, T. Gläßle,2014-2019, HIT Betriebs GmbH,2011-2013 Y.I. Levinsen, K. Fuchsberger (CERN)

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>